<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC '-//ibatis.apache.org//DTD Sql Map 2.0//EN' 'http://ibatis.apache.org/dtd/sql-map-2.dtd'>


<sqlMap namespace="bm">   
	<typeAlias alias="bmdto"  type="jackpot.DTO.bmDTO"/>
	<typeAlias alias="bpdto"  type="jackpot.DTO.dpDTO"/>

	<!--  모든업무불러오기  -->
		<select id="getBusiness" parameterClass="bmdto" resultClass="bmdto">
	
			<![CDATA[
				select bm_num,bm_tiltie,bm_content,bm_form,bm_start,bm_end,enrollment,reg_notice,cmp_notice,related_bns,bns_box,important,bm_state,emp_num, r 
				from (select bm_num,bm_tiltie,bm_content,bm_form,bm_start,bm_end,enrollment,reg_notice,cmp_notice,related_bns,bns_box,important,bm_state,emp_num, rownum r
				from business_manage where bm_num=#bm_num# order by bm_num desc) where rownum <= 1	
			]]>
	
		</select>
		
		
		<select id="getemp_name" parameterClass="string" resultClass="bmdto">
		
			select  e.emp_name from business_manage b,emp e where e.emp_num = b.emp_num 
		
		</select>
		
	<!--  나의 업무불러오기  -->
		<select id="getMyBusiness" parameterClass="bmdto" resultClass="bmdto">
	
			<![CDATA[
				select bm_num,bm_tiltie,bm_content,bm_form,bm_start,bm_end,enrollment,reg_notice,cmp_notice,related_bns,bns_box,important,bm_state,emp_num, r 
				from (select bm_num,bm_tiltie,bm_content,bm_form,bm_start,bm_end,enrollment,reg_notice,cmp_notice,related_bns,bns_box,important,bm_state,emp_num, rownum r
				from business_manage where emp_num=#emp_num# order by bm_num desc) where rownum <= 1
			]]>
	
		</select>
		
		
		
	
	<!--  업무입력  -->
		<insert id="insertBusiness1" parameterClass="bmdto">
	
				insert into business_manage(bm_num,bm_tiltie,bm_content,bm_form,bm_start,bm_end,enrollment,reg_notice,cmp_notice,related_bns,bns_box,important,bm_state) values(
					bm_seq.nextval,
					#bm_tiltie#,
					#bm_content#,
					#bm_form#,
					#bm_start#,
					#bm_end#,
					#enrollment#,
					#reg_notice#,
					#cmp_notice#,
					#related_bns#,
					#bns_box#,
					#important#,
					#bm_state#,
					#emp_num#
				)
				
		
		</insert>	
	
	
		<select id="member2" resultClass="odto" parameterClass="int" >
        	 select e.emp_num , e.emp_name, e.phone,e.mail,e.address,e.profilephoto profilephoto, p.position position,d.department department, e.position oo
   			  from emp e, position p ,department d where e.position=p.num and e.department=d.num and e.department=#department# order by e.position desc
     
        </select>
		
			<insert id="insertBusiness2" parameterClass="bmdto">
	
				insert into incharge() values(inc_num,inchar_name,inchar_brunch,inchar_depart,inchar_position)
					bm_seq.nextval,
					#bm_tiltie#,
					#bm_content#,
					#bm_form#,
					#bm_start#,
					#bm_end#,
					#enrollment#,
					#reg_notice#,
					#cmp_notice#,
					#related_bns#,
					#bns_box#,
					#important#,
					#bm_state#,
					#emp_num#
				)
				
		
		</insert>	
		
		
		
		
		<!--  담당자incharPop 불러오기  -->
		<select id="bm_org_department" resultClass="odto">
        	  select e.emp_name,p.position,d.department from emp e, position p,department d where p.num=e.position and e.department=d.num
        </select> 
        
        
        <!-- 부서불러오기 -->
        <select id="bm_de_department" resultClass="bpdto">
        	  select * from department 
        </select> 
        
        
        
        

</sqlMap>

