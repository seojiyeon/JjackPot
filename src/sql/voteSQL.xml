<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC '-//ibatis.apache.org//DTD Sql Map 2.0//EN' 'http://ibatis.apache.org/dtd/sql-map-2.dtd'>
<sqlMap namespace="vote">      

  <typeAlias alias="vdto" type="jackpot.DTO.voteDTO"/>
  <typeAlias alias="sdto" type="jackpot.DTO.voteProDTO"/>
  
  
    <insert id="insertVote" parameterClass="vdto">
      
            insert into vote(v_num,jilmoon,v_start,emp_num,notice,up_img,up_img2,monhang,monhang2) 
            values(vote_seq.nextval,#jilmoon#,sysdate,#emp_num#,0,#up_img#,#up_img2#,#monhang#,#monhang2#)
    </insert>
        
        
      <select id="voteSelect" resultClass="vdto" parameterClass="String">
        select * from vote where  emp_num=#emp_num# order by notice asc
      </select>
      
      
      <update id="Vupdate" parameterClass="int">
      
      	update vote set v_start=sysdate,notice=1 where v_num=#v_num#
      
      </update>
      
       <delete id="Vdel" >
          delete from vote where v_num=#v_num#
       </delete>
      
       <update id="EndVote" parameterClass="int">
      
      	update vote set notice=2,v_end=sysdate where v_num=#v_num#
      
      </update>
      
      <select id="UpVote" resultClass="vdto" parameterClass="vdto">
        select * from vote where notice=1 
      </select>
  
      <select id="UpVotePro" resultClass="vdto" parameterClass="int">
        select * from vote where v_num=#v_num#
      </select>
      
      <insert id="success" parameterClass="sdto">
        insert into votePro values(#v_num#,#emp_num#,#monhang#,#monhang2#,#vote_num#)
      </insert>
      
      <select id="VoteSelect" resultClass="int" parameterClass="sdto">
         select count(*)from votePro where v_num=#v_num# and vote_num=#vote_num#
      </select>
      
      
      <select id="v_num" resultClass="sdto" parameterClass="int">
              select s.v_num,v.jilmoon,v.notice,v.emp_num,v.monhang mm,v.monhang2 m2,v.up_img,v.up_img2,s.vote_num,s.monhang,s.monhang2
     from vote v,votePro s where  v.v_num=s.v_num and s.v_num=#v_num#
      </select>


      <select id="Result" resultClass="int" parameterClass="sdto">
       select count(*)from votePro where v_num=#v_num# and monhang=#monhang#
      </select>
      
       <select id="Result2" resultClass="int" parameterClass="sdto">
       select count(*)from votePro where v_num=#v_num# and monhang2=#monhang2#
      </select>
      
      
</sqlMap>




